<!-- 5f3de486-2d9c-4d20-884e-c147764aebb0 8357ff4e-d506-413a-9c91-df0fa3d7481e -->
# План: Поиск email на главной странице сайта

## Проблема

Stage 3 получает полный URL (например `https://www.rapiddirect.com/zh-CN/blog/cnc-machining-company-in-china/`) и ищет email на этой конкретной странице блога, где email нет. Нужно искать на главной странице домена (`https://www.rapiddirect.com`).

## Решение

### 1. Добавить метод извлечения домена

**Файл:** `src/stages/Stage3AnalyzeContacts.js`

**Добавить метод `_extractMainDomain(url)`:**

```javascript
_extractMainDomain(url) {
try {

### To-dos

- [ ] ✅ Clear Stage 4 validation data - 43 companies cleared
- [ ] ✅ Improve Stage 4 prompt - added manufacturer vs service distinction
- [ ] ✅ Re-run Stage 4 with improved validation - 44 companies validated
- [ ] ✅ Implement exponential backoff with jitter for Perplexity API
- [ ] ✅ Fix SettingsManager table name (settings → system_settings)
- [ ] ✅ Fix Stage 3 - finds emails (6 found, counters need fix)
- [ ] ✅ Stage 4 works - AI validation с DeepSeek
- [ ] ✅ Create optimized quick test script (2 queries, DB clear)
- [ ] ✅ Fix Perplexity markdown parsing
- [ ] ✅ Stage 1 works - saves companies to DB
- [ ] ✅ Fix Stage 1 - saves to DB (47 companies, counters need fix)
- [ ] ✅ Кэширование отключено
- [ ] ✅ Results page created - view and manage companies